<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.73.0" />

    
    
    

<title>Why I&#39;d choose Apache Wicket as a web application framework â€¢ Serban Balamaci</title>













    
<meta property="og:locale" content="en">
<meta property="og:site_name" content="Serban Balamaci">
<meta property="og:title" content="Why I&amp;rsquo;d choose Apache Wicket as a web application framework">
<meta property="og:type" content="website">
<meta property="og:url" content="https://balamaci.ro/2011/11/02/why-choose-apache-wicket-framework/" />
<meta property="og:description" content="Apache Wicket is a great stateful component based framework which cultivates a sound architecture that appeals to Java developers">
<meta property="og:image" content="https://balamaci.ro/social-sharing.png">
<meta property="og:image:type" content="image/png">
    
    
    
<meta property="og:image:width" content="192">
<meta property="og:image:height" content="192">
    

<meta property="og:updated_time" content="2011-11-02T11:40:00Z">



<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@sbalamaci">
<meta name="twitter:title" content="Why I&amp;rsquo;d choose Apache Wicket as a web application framework">

<meta name="twitter:image" content="https://balamaci.ro/social-sharing.png">

<meta name="twitter:description" content="Apache Wicket is a great stateful component based framework which cultivates a sound architecture that appeals to Java developers">
<meta name="twitter:creator" content="@sbalamaci">
    
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/a11y-light.min.css" media="(prefers-color-scheme: light)"><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/gruvbox-dark.min.css" media="(prefers-color-scheme: dark)">




<link rel="stylesheet" href="/scss/hyde-hyde.57d57be207f95258b69c5563e34ed2c632000ecb862ce9bd97e7e35f3957094c.css" integrity="sha256-V9V74gf5Uli2nFVj407SxjIADsuGLOm9l&#43;fjXzlXCUw=">


<link rel="stylesheet" href="/scss/hyde-hyde-dark.2eddfb769610f72f40f6bc949e62a3acf298eb8504c073739085a417978b18cd.css" integrity="sha256-Lt37dpYQ9y9A9ryUnmKjrPKY64UEwHNzkIWkF5eLGM0=" media="(prefers-color-scheme: dark)">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    
    <link rel="shortcut icon" sizes="192x192" href="/android-192-favicon.png">

    
    <link rel="shortcut icon" href="/android-192-favicon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/v4-shims.min.css" integrity="sha256-wN7QJaqAwQ03kgUhyN4EU2phRdDkLrQYbFe0EvpQ60U=" crossorigin="anonymous" />

    
    


    
</head>


    <body class="">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://balamaci.ro">Serban Balamaci</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/309afbf8c2f162060e4fa28d670d2ec8?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
         Java and JVM related 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Serban Balamaci</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/"><span class='fa-icon'><i class='fas fa-home'></i></span> Home
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/posts/"><span class='fa-icon'><i class='fas fa-stream'></i></span> Posts
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/series/"><span class='fa-icon'><i class='fas fa-list-alt'></i></span> Series
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/"><span class='fa-icon'><i class='fas fa-tags'></i></span> Tags
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/whoami/"><span class='fa-icon'><i class='fas fa-id-card'></i></span> About
						<span></span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/@sbalamaci" rel="me"><i class="fa-w-16" aria-hidden="true"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="bird" class="svg-inline--fa fa-bird fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></i></a>
	
	
	
	<a href="https://github.com/balamaci" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/serbanbalamaci" rel="me"><i class="fa-w-16" aria-hidden="true"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="pro-network" class="svg-inline--fa fa-pro-network fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></i></a>
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>

  </div>
  <div class="container fixed-container">
    
<div class="copyright">
  &copy; 2010 - 2020 Serban Balamaci
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    

<article>
  <header>
    <h1>Why I&#39;d choose Apache Wicket as a web application framework</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> 2011-11-02
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/wicket">WICKET</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/wicket">wicket</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 28 min read

    
    
    

</div>


  </header>
  
  
  
  <div class="post md">
    <p>In a short description <!-- raw HTML omitted -->Apache Wicket<!-- raw HTML omitted --> is a great <em>stateful component based framework</em> which cultivates a sound architecture that appeals to Java developers. This is just going to be a general summary of the points of why you might want to have a look at the framework.
Let&rsquo;s begin:</p>
<h4 id="clean-separation-of-java-code-from-html">Clean separation of Java code from HTML</h4>
<p>One of the best and most talked about Wicket feature is of course the clear separation of HTML from Java code.
<!-- raw HTML omitted -->No more Java code inside HTML<!-- raw HTML omitted -->(yes that&rsquo;s you JSP). In Wicket we have pages composed of panels with components and for every page/panel we get two files: a <!-- raw HTML omitted -->.java<!-- raw HTML omitted --> file and one <!-- raw HTML omitted -->.html<!-- raw HTML omitted --> file which sit next to each other in a java package structure(this could be changed and have separate locations for html and java files) and both get packed into the final war.
Java components are matched to html by adding a wicket:id=&quot;javaComponentName&rdquo; attribute for a html tag.</p>
<p>All the logic resides in Java so this makes the code compile time safe, also it means that the code can be debugged and unit tests created for it.</p>
<h4 id="no-custom-tags-other-than-html">No custom tags other than HTML</h4>
<p><!-- raw HTML omitted -->No custom tags<!-- raw HTML omitted --> other than plain HTML are used nor any templating syntax to remember. HTML and CSS is the web language, we don&rsquo;t need to learn more vendor specific tags thank you. <!-- raw HTML omitted -->No XML files<!-- raw HTML omitted --> used for configuration either.</p>
<h4 id="share-the-work-with-a-frontend-developer">Share the work with a frontend developer</h4>
<p>Both separated logic and no custom tags lead to a <!-- raw HTML omitted -->.html<!-- raw HTML omitted --> file which is now fully standards compliant and you can delegate the work of the UI layout to a specialised front-end developer instead of doing it yourself and are pretty safe of not getting on each other toes. Being standard html the frontend developer can use his favourite tool to edit the file.</p>
<p>All in all that means it is faster to get from PSD files =&gt; HTML =&gt; Page =&gt; Component.</p>
<h3 id="easy-refactoring">Easy refactoring</h3>
<p>Sometimes the requirements and business specifications for a project change or we&rsquo;d like to improve on our code as we advance in the project, so refactoring the code should be easy in a web framework(for many it is not). Due to the nature of the components as Java objects it means that refactoring is not very different from what you would do for a non-web Java application. This means, you as a developer have a low response time to changes of the requirements.</p>
<h4 id="component-based-framework-with-good-concepts-that-appeals-to-developers">Component based framework with good concepts that appeals to developers</h4>
<p>But the best thing for me is that Wicket really feels like a true Object Oriented web framework. All your components, pages, panels are Java objects(with a .html). Every web component extends a base <!-- raw HTML omitted -->Component<!-- raw HTML omitted --> class and can in turn be extended. Another way of creating components in Wicket is through composition of other web components inside a <!-- raw HTML omitted -->Panel<!-- raw HTML omitted -->. You can pack your components inside a jar file and bring them into another project and ideally a common library of components in your organisation might emerge. A place with generic open source components is the <!-- raw HTML omitted -->Wicket Stuff project<!-- raw HTML omitted --> or the <!-- raw HTML omitted -->Visural Wicket project<!-- raw HTML omitted --></p>
<p>Wicket also comes with built in <!-- raw HTML omitted -->Validators<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Converters<!-- raw HTML omitted --> or interfaces to implement your own.</p>
<p>Wicket cultivates a nice architectural pattern by imposing that every Component be backed up by a <!-- raw HTML omitted -->Model<!-- raw HTML omitted -->. It is the Model for the Component which <!-- raw HTML omitted -->handles the data retrieval<!-- raw HTML omitted -->. Same component can be used with different Model implementations that provide the data from different sources or ways.
Think also of building and reusing generic Models like one that knows how to retrieve say through  Spring-Data an entity by ID.</p>
<p>Wicket provides a series of predefined Models, and a good understanding of what Models are and how/when each should be used is a very important thing to pay special attention when learning Wicket.</p>
<p><!-- raw HTML omitted -->Behaviours<!-- raw HTML omitted --> are another concept that has been separated from Component. The reason for this is that even how a component &ldquo;behaves&rdquo; may be similar to another component&rsquo;s behaviour and such can be a candidate for reuse or extension. Ajax is an example of being one such cross component behaviour.</p>
<p>In Wicket you can also use <!-- raw HTML omitted -->Visitors<!-- raw HTML omitted -->(based on the <!-- raw HTML omitted -->Visitor pattern<!-- raw HTML omitted -->) for transversal of components in a Page.</p>
<p>Wicket from version 1.5 provides an <!-- raw HTML omitted -->EventBus<!-- raw HTML omitted --> mechanism through which components can communicate.</p>
<p>Because Wicket has been designed from the beginning as being <!-- raw HTML omitted -->stateful<!-- raw HTML omitted --> you can pass around Java objects(a good habit to get into is to actually pass Models) from one Page instance to another. Apart from the clearer intent and easier way to follow which pages use a particular Model, this may also be seen as an inherit security bonus. For example a user cannot force access to a Checkout page with url parameters but needs to create the Model object by passing through all the steps of the flow until checkout. Also that state will be tied to a particular page instance and you do not have to explicitly handle cleanup.</p>
<h4 id="good-integration-with-spring">Good integration with Spring</h4>
<p>Worth mention is the good integration with Dependency Injection frameworks like Spring/Guice. You can easily inject Spring beans inside any of your pages,panels,components,models by only providing the <!-- raw HTML omitted -->@SpringBean<!-- raw HTML omitted --> annotation.
Think of an example of a DetachableModel in which you injected a GeneralDAO that looks up and loads an entity by class and id, and you have an example of a reusable model component that knows how to populate itself when needed. Extend the idea to a html table repeater and you have a component&rsquo;s model to which you only have to pass the entity class and provides you data retrieval with pagination. (As a side note, I work with <!-- raw HTML omitted -->hibernate-generic-dao<!-- raw HTML omitted --> to build a GenericTableModel on this idea that also takes a <!-- raw HTML omitted -->Filter<!-- raw HTML omitted --> object as parameter and reuse it in all my projects as it covers most all of my tables usage).</p>
<h3 id="your-session-is-a-pojo">Your Session is a POJO</h3>
<p>In Wicket, you do not directly access HttpSession, instead you create your own Plain Java Bean Object as a WebSession. This helps with refactoring, because now instead of the Map structure of HttpSession, you have a Java object who&rsquo;s properties and methods you can track to where they are used in your project. But it is good practice to use the Session to store only global application information like user context, and use Models for storing the business logic data.</p>
<h4 id="about-wicket-and-js">About Wicket and JS</h4>
<p>Even from the beginning Wicket had Ajax capabilities built-in, that could be called from Java. This is done by simply adding the Java component to an ajax context object, the <!-- raw HTML omitted -->AjaxRequestTarget<!-- raw HTML omitted -->. Of course you can invoke any JavaScript code before or after the Ajax call.</p>
<p>Wicket does not generate any JS files from Java, unlike GWT frameworks and tries to keep things simple and clean so that it feels like you are in control of what HTML and JS gets generated by the framework.</p>
<h4 id="wickettester-enables-and-makes-writing-unit-tests-easy">WicketTester enables and makes writing Unit Tests easy</h4>
<p>Again Wicket developers kept testability in mind when they created Wicket and created the WicketTester class that exposes a rich API, for easy writing Unit Tests for Pages and components. Using WicketTester you can check that pages and components render without errors, forms submit and page navigation and test ajax behaviours without problems in a headless environment(non GUI).
I like also that you do not modify your application Pages and components in any way to integrates Spring it allows and that I can test the full flow of the application without doing any special modifications.</p>
<h4 id="security">Security</h4>
<p>Wicket offers support for component level security. Entire panels or components can be automatically be shown or hidden if the user has a certain security level. Of course it&rsquo;s still easy to provide the standard page level authorisation model most projects require.
Wicket can also be easily integrated with <!-- raw HTML omitted -->Spring Security<!-- raw HTML omitted -->.</p>
<h4 id="internalisation-support">Internalisation support.</h4>
<p>Wicket has good internationalisation support by using property files, or can be customised to handle any situation like for example strings loaded from the database.</p>
<h4 id="wicket-is-free-and-open-source">Wicket is free and open source.</h4>
<p>No need to say more.</p>
<h4 id="does-not-impose-a-single-page-application-architecture">Does not impose a Single Page Application architecture.</h4>
<p>You could build a single page application in Wicket with no problems by having your panels replaced by ajax but you are not forced to do it. Other framework either impose it, or make it harder to have you application multi page. (SPA usually have issues with SEO)</p>
<!-- raw HTML omitted -->
<p>There are many Wicket tutorials and blog entries to get you started, best of being or you could check the source code for the <!-- raw HTML omitted --><!-- raw HTML omitted --> or the <!-- raw HTML omitted --><!-- raw HTML omitted -->, and at least two books worth mention: <!-- raw HTML omitted -->Wicket in Action<!-- raw HTML omitted --> and <!-- raw HTML omitted -->Wicket Cookbook<!-- raw HTML omitted --> for the more advanced.</p>
<h2 id="framework-minus-points">Framework minus points</h2>
<p>To be fair I have to say something about what I think are the current weakness of the framework:</p>
<ol>
<li>Building a stateless application requires extra work and knowledge.
Remember that Wicket has been developed for stateful applications. But there are a number of reasons why you&rsquo;d want to opt for a stateless application.
Because if your application is stateless it means that requests can be processed by any of the web servers in your cluster, because all the parameters a page needs to reproduce a certain state are provided in the url. In a stateful application you either have to turn on session replication for the cluster(and infer a performance penalty on memory and network usage to keep sessions replicated on all machines) or more simply turn on sticky sessions to make sure that subsequent requests land on the same server where the user&rsquo;s session was created and contains the data.</li>
</ol>
<p>Another reason could be that for a stateful application a http session must be created, which is kept in the url as the parameter &ldquo;jsessionid&rdquo; when indexed by <!-- raw HTML omitted -->search engines<!-- raw HTML omitted -->, and this might not look nice for a user seeing your page url returned as a search result.</p>
<p>But if you insist of keeping your application stateless is not really that hard though, and it may seem hard because you will be doing things that Wicket was doing for you and took for granted, and practically you&rsquo;ll just have to face the same thing that developers using stateless frameworks do everyday.
The community provides support on this topic and replacement stateless components have been developed.</p>
<ol start="2">
<li>
<p>Because currently Wicket has it&rsquo;s own JS Ajax engine, when changing the DOM structure through Wicket Ajax(replacing a panel for ex), your JQuery selectors have to run again on the new DOM structure. This can easily be bypassed by packaging your selectors in a JS method and call it after doing the ajax operation.
As stated above, using JQuery for doing Wicket ajax is on the roadmap, and this little inconvenience may dissapear on it&rsquo;s own.</p>
</li>
<li>
<p>With Wicket, the session size tends to get big if you do not know how to detach your models. So this might hurt you in a way that it&rsquo;s not evident from the start but when your userbase grows. Having to know the framework I suppose it does go without saying and it&rsquo;s a must for just any framework, but I just wanted to reiterate that I advise you as a new wicketer to take some time to really understand Models as they are an important concept in Wicket, especially <!-- raw HTML omitted -->DetachableModels<!-- raw HTML omitted -->.</p>
</li>
<li>
<p>It has a higher learning curve because it&rsquo;s harder to find good object oriented programmers. Some people even learn to develop more Object Oriented and clean because of Wicket. Even if you are a Java programmer but come from a procedural way of programming JSP, Struts, Stripes you might get frustrated of having to instantiate components with models instead of the quick&amp;dirty way of just throwing in some code in html. Don&rsquo;t get me wrong, there are situations when the quick and dirty way might be the way to go, as stated for conclusions, Wicket like any framework should be used where it brings value, not as the proverbial hammer with everything looking as nails.</p>
</li>
<li>
<p>Performance testing done with tools which do not simulate real clicking on web components, but rather build URLs with parameters, much like JMeter does, requires an analysis of how Wicket generates the urls and how to match them, by the people doing the performance testing(because Wicket is stateful a page version parameter is encoded in the url, and also study the url on how to target specific Ajax <!-- raw HTML omitted -->Behaviours<!-- raw HTML omitted --> in the page).</p>
</li>
</ol>
<p>As the closing statement I think and let me point out that I&rsquo;m also a true believer of using the right tool for the right job and that in some cases Wicket might prove overkill. For example if I&rsquo;d want a read-only site like say a blog, then I&rsquo;d probably go for a light PHP CMS solution like Wordpress(or Ghost since I&rsquo;ve imported this post recently into it).</p>
<p>Or if you have a desktop like application and you require out of the box heavy JS components that look good and don&rsquo;t need customisation then maybe I&rsquo;d use <a href="http://vaadin.com">Vaadin</a>. Whatever the case I&rsquo;d say if you are looking for a component based and you like you should at least give Wicket a try and so to set you on the right path just use the following Maven Wicket Quickstart archetype to generate and run yourself a very simple Wicket project:</p>
<pre><code>mvn archetype:generate -DarchetypeGroupId=org.apache.wicket -DarchetypeArtifactId=wicket-archetype-quickstart -DarchetypeVersion=1.5-SNAPSHOT -DgroupId=com.mycompany -DartifactId=myproject -DarchetypeRepository=https://repository.apache.org/content/repositories/snapshots/ -DinteractiveMode=false
</code></pre>

  </div>
  

<div class="navigation navigation-single">
    
    
    <a href="/2012/03/26/more-secure-than-yesterday-trying-to-prevent-brute-force-attacks/" class="navigation-next">
      <span class="navigation-tittle">More Secure than Yesterday - Trying to prevent Brute-force attacks</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  

</article>


        </div>
        
    










<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    

<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js" integrity="sha256-vrn14y7WH7zgEElyQqm2uCGSQrX/xjYDjniRUQx3NyU=" crossorigin="anonymous"></script>
<script type="text/javascript">
function addBlockSwitches() {
	$('.primary').each(function() {
		primary = $(this);
		createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
		primary.children('.title').remove();
	});
	$('.secondary').each(function(idx, node) {
		secondary = $(node);
		primary = findPrimary(secondary);
		switchItem = createSwitchItem(secondary, primary.children('.switch'));
		switchItem.content.addClass('hidden');
		findPrimary(secondary).append(switchItem.content);
		secondary.remove();
	});
}

function createBlockSwitch(primary) {
	blockSwitch = $('<div class="switch"></div>');
	primary.prepend(blockSwitch);
	return blockSwitch;
}

function findPrimary(secondary) {
	candidate = secondary.prev();
	while (!candidate.is('.primary')) {
		candidate = candidate.prev();
	}
	return candidate;
}

function createSwitchItem(block, blockSwitch) {
	blockName = block.children('.title').text();
	content = block.children('.content').first().append(block.next('.colist'));
	item = $('<div class="switch--item">' + blockName + '</div>');
	blockSwitch.append(item);
	return {'item': item, 'content': content};
}

function globalSwitch() {
	$('.switch--item').each(function() {
		var blockId = blockIdForSwitchItem($(this));
		$(this).off('click');
		$(this).on('click', function() {
			selectedText = $(this).text()
			window.localStorage.setItem(blockId, selectedText);
			$(".switch--item").filter(function() {
				return blockIdForSwitchItem($(this)) === blockId;
			}).filter(function() {
				return $(this).text() === selectedText;
			}).each(function() {
				select($(this))
			});
		});
		if ($(this).text() === window.localStorage.getItem(blockId)) {
			select($(this))
		}
	});
}

function blockIdForSwitchItem(item) {
	idComponents = []
	idComponents.push(item.text().toLowerCase());
	item.siblings(".switch--item").each(function(index, sibling) {
		idComponents.push($(sibling).text().toLowerCase());
	});
	return idComponents.sort().join("-")
}

function select(selected) {
	selected.addClass('selected');
	selected.siblings().removeClass('selected');
	selectedContent = selected.parent().siblings(".content").eq(selected.index())
	selectedContent.removeClass('hidden');
	selectedContent.siblings().addClass('hidden');
}

$(addBlockSwitches);
$(globalSwitch);
</script>


    



    </body>
</html>

